{"ast":null,"code":"import _regeneratorRuntime from\"/Users/apple/Documents/openbush/openbush_frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/apple/Documents/openbush/openbush_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/apple/Documents/openbush/openbush_frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/apple/Documents/openbush/openbush_frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/apple/Documents/openbush/openbush_frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/apple/Documents/openbush/openbush_frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/apple/Documents/openbush/openbush_frontend/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'antd/dist/antd.css';import{Tag,Image,Form,Layout,Button,Typography,Descriptions,List,PageHeader,Modal,InputNumber,message}from'antd';import contractInstance from'../../utils/config';import web3 from'../../utils/InitWeb3';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Content=Layout.Content;var MyNFTCard=/*#__PURE__*/function(_React$Component){_inherits(MyNFTCard,_React$Component);var _super=_createSuper(MyNFTCard);function MyNFTCard(props){var _this;_classCallCheck(this,MyNFTCard);_this=_super.call(this,props);_this.formRef=/*#__PURE__*/React.createRef();_this.renderContent=function(){var column=arguments.length>0&&arguments[0]!==undefined?arguments[0]:3;return/*#__PURE__*/_jsxs(Descriptions,{size:\"small\",column:column,bordered:true,children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u540D\\u79F0\",children:_this.state.NFT.name}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u63CF\\u8FF0\",children:_this.state.NFT.description}),/*#__PURE__*/_jsxs(Descriptions.Item,{label:\"\\u4EF7\\u683C\",children:[web3.utils.fromWei(_this.state.NFT.startprice.toString(),\"ether\"),\" ether\"]})]});};_this.renderOwners=function(){return/*#__PURE__*/_jsx(List,{header:/*#__PURE__*/_jsx(\"div\",{children:\"\\u6D41\\u8F6C\\u4FE1\\u606F\"}),bordered:true,dataSource:_this.state.owners,renderItem:function renderItem(item){return/*#__PURE__*/_jsxs(List.Item,{children:[/*#__PURE__*/_jsx(Typography.Text,{mark:true,children:\"[ADDRESS]\"}),\" \",item]});}});};_this.state={NFT:props.NFT,isConnected:false,address:\"\",buttonDisable:false,tagColor:\"blue\",NFTState:\"私有\",modalVisible:false,owners:[]};_this.renderContent=_this.renderContent.bind(_assertThisInitialized(_this));_this.sell=_this.sell.bind(_assertThisInitialized(_this));return _this;}_createClass(MyNFTCard,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var accounts,NFT,owners,ret,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return web3.eth.getAccounts();case 2:accounts=_context.sent;if(!(accounts.length==0)){_context.next=7;break;}this.setState({isConnected:false});_context.next=28;break;case 7:this.setState({isConnected:true,address:accounts[0]});NFT=this.state.NFT;if(NFT.onsale==false&&NFT.setaside==false){this.setState({NFTState:\"私有\",tagColor:\"blue\",buttonDisable:false});}else if(NFT.onsale==true){this.setState({NFTState:\"拍卖中\",tagColor:\"red\",buttonDisable:true});}else if(NFT.setaside==true){this.setState({NFTState:\"拍卖结束（等待申领）\",tagColor:\"green\",buttonDisable:true});}//获取流转信息\n_context.prev=10;owners=[];i=0;case 13:if(!(i<NFT.ownerNum)){_context.next=21;break;}_context.next=16;return contractInstance.methods.owners(NFT.id,i).call();case 16:ret=_context.sent;owners.push(ret);case 18:i++;_context.next=13;break;case 21:console.log(owners);this.setState({owners:owners});_context.next=28;break;case 25:_context.prev=25;_context.t0=_context[\"catch\"](10);console.log(_context.t0);case 28:case\"end\":return _context.stop();}}},_callee,this,[[10,25]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"sell\",value://售卖函数\nfunction(){var _sell=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var NFT,values,tx;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:NFT=this.state.NFT;values=this.formRef.current.getFieldValue();console.log(NFT.id,typeof NFT.id);console.log(values.price,typeof values.price);console.log(values.timespan,typeof values.timespan);console.log(this.state.address);console.log(Number(NFT.id),typeof Number(NFT.id));_context2.prev=7;_context2.next=10;return contractInstance.methods.sell(Number(NFT.id),web3.utils.toWei(values.price.toString(),\"ether\"),values.timespan).send({from:this.state.address,value:web3.utils.toWei('0.00000001','ether')});case 10:tx=_context2.sent;message.success('拍卖提交成功');window.location.reload();_context2.next=19;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](7);console.log(_context2.t0);message.error(\"拍卖提交失败\");case 19:case\"end\":return _context2.stop();}}},_callee2,this,[[7,15]]);}));function sell(){return _sell.apply(this,arguments);}return sell;}()},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{style:{boxShadow:\"2px 2px 1px 2px #888\",margin:\"5px\"},children:[/*#__PURE__*/_jsx(PageHeader,{title:this.state.NFT.id,tags:/*#__PURE__*/_jsx(Tag,{color:this.state.tagColor,children:this.state.NFTState}),extra:[/*#__PURE__*/_jsx(Button,{type:\"primary\",disabled:this.state.buttonDisable,onClick:function onClick(){return _this2.setState({modalVisible:true});},children:\"\\u62CD\\u5356\"},\"1\")]}),/*#__PURE__*/_jsx(Image,{width:200,height:200,src:this.state.NFT.uri}),/*#__PURE__*/_jsx(Content,{children:this.renderContent()}),/*#__PURE__*/_jsx(Content,{children:this.renderOwners()}),/*#__PURE__*/_jsx(Modal,{visible:this.state.modalVisible,title:\"\\u62CD\\u5356\",okText:\"\\u63D0\\u4EA4\",cancelText:\"\\u53D6\\u6D88\",onCancel:function onCancel(){_this2.setState({modalVisible:false});},onOk:function onOk(){_this2.sell();_this2.formRef.current.resetFields();},children:/*#__PURE__*/_jsxs(Form,{ref:this.formRef,layout:\"vertical\",name:\"sellForm\",initialValues:{modifier:'public'},children:[/*#__PURE__*/_jsx(Form.Item,{name:\"price\",label:\"\\u8D77\\u62CD\\u4EF7\\u683C\",rules:[{required:true,message:'请填写起拍价格'}],children:/*#__PURE__*/_jsx(InputNumber,{min:1,max:10000000000})}),/*#__PURE__*/_jsx(Form.Item,{name:\"timespan\",label:\"\\u62CD\\u5356\\u671F\\u9650(\\u5355\\u4F4D\\uFF1A\\u79D2)\",rules:[{required:true,message:'请填写拍卖期限(最长时间30天)'}],children:/*#__PURE__*/_jsx(InputNumber,{min:60,max:30*24*3600})})]})})]});}}]);return MyNFTCard;}(React.Component);export default MyNFTCard;","map":{"version":3,"sources":["/Users/apple/Documents/openbush/openbush_frontend/src/Dapp/components/card/my-nft-card.js"],"names":["React","Tag","Image","Form","Layout","Button","Typography","Descriptions","List","PageHeader","Modal","InputNumber","message","contractInstance","web3","Content","MyNFTCard","props","formRef","createRef","renderContent","column","state","NFT","name","description","utils","fromWei","startprice","toString","renderOwners","owners","item","isConnected","address","buttonDisable","tagColor","NFTState","modalVisible","bind","sell","eth","getAccounts","accounts","length","setState","onsale","setaside","i","ownerNum","methods","id","call","ret","push","console","log","values","current","getFieldValue","price","timespan","Number","toWei","send","from","value","tx","success","window","location","reload","error","boxShadow","margin","uri","resetFields","modifier","required","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport { Tag, Image, Form, Layout, Button, Typography, Descriptions, List, PageHeader, Modal, InputNumber, message } from 'antd';\r\nimport contractInstance from '../../utils/config';\r\nimport web3 from '../../utils/InitWeb3';\r\n\r\n\r\nconst {Content} = Layout;\r\n\r\nclass MyNFTCard extends React.Component{\r\n    formRef = React.createRef();\r\n\r\n    constructor(props){\r\n        super(props);\r\n        this.state = ({\r\n            NFT: props.NFT,\r\n            isConnected: false,\r\n            address: \"\",\r\n            buttonDisable: false,\r\n            tagColor: \"blue\",\r\n            NFTState: \"私有\",\r\n            modalVisible: false,\r\n            owners: [],\r\n        })\r\n        \r\n\r\n        this.renderContent = this.renderContent.bind(this);\r\n        this.sell = this.sell.bind(this);\r\n    }\r\n\r\n    async componentDidMount(){\r\n\r\n        let accounts = await web3.eth.getAccounts()\r\n        if (accounts.length == 0) {\r\n            this.setState({\r\n                isConnected: false\r\n            })\r\n        }\r\n        else {\r\n            this.setState({\r\n                isConnected: true,\r\n                address: accounts[0]\r\n            })\r\n            \r\n            let NFT = this.state.NFT;\r\n            if(NFT.onsale == false && NFT.setaside == false){\r\n                this.setState({\r\n                    NFTState: \"私有\",\r\n                    tagColor: \"blue\",\r\n                    buttonDisable: false,\r\n                })\r\n            }\r\n            else if(NFT.onsale == true){\r\n                this.setState({\r\n                    NFTState: \"拍卖中\",\r\n                    tagColor: \"red\",\r\n                    buttonDisable: true,\r\n                })\r\n            }\r\n            else if(NFT.setaside == true){\r\n                this.setState({\r\n                    NFTState: \"拍卖结束（等待申领）\",\r\n                    tagColor: \"green\",\r\n                    buttonDisable: true,\r\n                })\r\n            }\r\n\r\n            //获取流转信息\r\n            try{\r\n                let owners = [], ret;\r\n                for(let i = 0; i < NFT.ownerNum; i++){\r\n                    ret = await contractInstance.methods.owners(NFT.id, i).call();\r\n                    owners.push(ret);\r\n                }\r\n                console.log(owners);\r\n                this.setState({\r\n                    owners: owners,\r\n                })\r\n            }\r\n            catch(e){\r\n                console.log(e);\r\n            }\r\n        }\r\n    }\r\n    \r\n    renderContent = (column = 3) =>(\r\n        <Descriptions size=\"small\" column={column} bordered>\r\n            <Descriptions.Item label=\"名称\">{this.state.NFT.name}</Descriptions.Item>\r\n            <Descriptions.Item label=\"描述\">{this.state.NFT.description}</Descriptions.Item>\r\n            <Descriptions.Item label=\"价格\">{web3.utils.fromWei((this.state.NFT.startprice).toString(), \"ether\")} ether</Descriptions.Item>\r\n        </Descriptions>\r\n    );\r\n\r\n    renderOwners = () =>(\r\n        <List\r\n        header={<div>流转信息</div>}\r\n        bordered\r\n        dataSource={this.state.owners}\r\n        renderItem={item => (\r\n            <List.Item>\r\n                <Typography.Text mark>[ADDRESS]</Typography.Text> {item}\r\n            </List.Item>\r\n      )}\r\n        />\r\n    );\r\n\r\n    //售卖函数\r\n    async sell(){\r\n        let NFT = this.state.NFT;\r\n        let values = this.formRef.current.getFieldValue();\r\n        console.log(NFT.id, typeof(NFT.id));\r\n        console.log(values.price, typeof(values.price));\r\n        console.log(values.timespan, typeof(values.timespan));\r\n        console.log(this.state.address)\r\n        console.log(Number(NFT.id), typeof(Number(NFT.id)))\r\n        try{\r\n            let tx = await contractInstance.methods.sell(Number(NFT.id), web3.utils.toWei((values.price).toString(), \"ether\"), values.timespan).send({\r\n                from: this.state.address,\r\n                value: web3.utils.toWei('0.00000001', 'ether'),\r\n            })\r\n            message.success('拍卖提交成功');\r\n            window.location.reload();\r\n        }\r\n        catch(e){\r\n            console.log(e);\r\n            message.error(\"拍卖提交失败\");\r\n        }\r\n    }\r\n\r\n    render(){\r\n        return(\r\n            <div style={{boxShadow: \"2px 2px 1px 2px #888\", margin: \"5px\"}}>\r\n                <PageHeader\r\n                    title={this.state.NFT.id}\r\n                    tags={<Tag color={this.state.tagColor}>{this.state.NFTState}</Tag>}\r\n                    extra={[\r\n                        <Button key=\"1\" type=\"primary\" disabled={this.state.buttonDisable} onClick={()=>this.setState({\r\n                            modalVisible: true,\r\n                        })}>\r\n                            拍卖\r\n                        </Button>\r\n                    ]}>\r\n                </PageHeader>\r\n                <Image width={200} height={200} src={this.state.NFT.uri} />\r\n                <Content>{this.renderContent()}</Content>\r\n                <Content>{this.renderOwners()}</Content>\r\n\r\n                <Modal\r\n                    visible={this.state.modalVisible}\r\n                    title=\"拍卖\"\r\n                    okText=\"提交\"\r\n                    cancelText=\"取消\"\r\n                    onCancel={()=>{\r\n                        this.setState({\r\n                            modalVisible: false,\r\n                        })\r\n                    }}\r\n                    onOk={()=>{\r\n                        this.sell();\r\n                        this.formRef.current.resetFields();\r\n                    }}>\r\n                        <Form\r\n                            ref={this.formRef}\r\n                            layout=\"vertical\"\r\n                            name=\"sellForm\"\r\n                            initialValues={{modifier: 'public'}}\r\n                        >\r\n                            <Form.Item\r\n                                name=\"price\"\r\n                                label=\"起拍价格\"\r\n                                rules={[{ required: true, message: '请填写起拍价格' }]}\r\n                            >\r\n                                <InputNumber min={1} max={10000000000}></InputNumber>\r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                name=\"timespan\"\r\n                                label=\"拍卖期限(单位：秒)\"\r\n                                rules={[{ required: true, message: '请填写拍卖期限(最长时间30天)' }]}\r\n                            >\r\n                                <InputNumber min={60} max={30*24*3600}></InputNumber>\r\n                            </Form.Item>\r\n                        </Form>\r\n                    </Modal>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default MyNFTCard;"]},"metadata":{},"sourceType":"module"}